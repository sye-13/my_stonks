syntax = "proto3";

message Stock {
  string id = 1;
  string name = 2;
  double current_price = 3;
  double initial_price = 4;
}

message ETF {
  string id = 1;
  string name = 2;
  double current_price = 3;
  double initial_price = 4;
}

message Asset {
  oneof asset_type {
    Stock stock = 1;
    ETF etf = 2;
  }
}

message PerformanceHistory {
  int64 timestamp = 1; // Timestamp in milliseconds since epoch
  double value = 2;
}

message AssetWithPerformanceHistory {
  Asset asset = 1;
  repeated PerformanceHistory history = 2;
}

message Empty {}

message AssetListUpdate {
  repeated AssetWithPerformanceHistory assets = 1;
  bool success = 2;
  string message = 3;
}

service AssetsService {
  rpc StreamAssets(Empty) returns (stream AssetListUpdate);
  rpc UpdateAsset(AssetWithPerformanceHistory) returns (AssetListUpdate);
}
